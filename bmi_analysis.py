import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import silhouette_score\n\n# Read the Excel file\ndef read_data(file_path):\n    data = pd.read_excel(file_path)\n    return data\n\n# Calculate BMI\ndef calculate_bmi(data):\n    data['BMI'] = data['Weight'] / (data['Height'] ** 2)\n    return data\n\n# Perform clustering analysis\ndef perform_clustering(data):\n    X = data[['BMI']]\n    kmeans = KMeans()\n    param_grid = {'n_clusters': [2, 3, 4, 5, 6]}\n    grid_search = GridSearchCV(kmeans, param_grid, cv=5)\n    grid_search.fit(X)\n    best_model = grid_search.best_estimator_\n    data['Cluster'] = best_model.predict(X)\n    return data, best_model\n\n# Visualize results\ndef visualize_clusters(data, model):\n    plt.figure(figsize=(10, 6))\n    sns.scatterplot(data=data, x='BMI', y='Cluster', hue='Cluster', palette='viridis', style='Cluster')\n    plt.title('BMI Clustering')\n    plt.xlabel('BMI')\n    plt.ylabel('Cluster')\n    plt.savefig('bmi_clustering_results.png')\n    plt.show()\n\n# Save results to output files\ndef save_results(data):\n    data.to_csv('bmi_clustering_results.csv', index=False)\n\nif __name__ == "__main__":\n    file_path = r"C:\Users\chz\Desktop\工作簿2.xlsx"\n    data = read_data(file_path)\n    data = calculate_bmi(data)\n    clustered_data, model = perform_clustering(data)\n    visualize_clusters(clustered_data, model)\n    save_results(clustered_data)\n